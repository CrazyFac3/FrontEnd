<!DOCTYPE html>
<html>

<head>
    <title>chat</title>
    <link rel="stylesheet" href="../styles/chatStyle.css"/>
    <link rel="stylesheet" href="../styles/colors.css"/>
    <script> var myId = null; var friendId = null;</script>
    <script src="../settings/loginSettings.js"></script>
    <script src="../settings/chatScript.js"></script>
    <meta charset='utf8'/>
    <meta name="viewport" content=content="width=device-width, user-scalable=no" />
</head>

<body class="background-c">

    <button onclick="location.href = './contacts.html';setFlag()" ; type="button" class="back-button background-c";>&#x2B05</button>
    <div id="header">
        <div class="top-img">
            <img src="../images/user.jpg" id= "user" class="user" />
            <img src="../images/friend.jpeg" id="friend" class="user" />
        </div>
        <script>setImg()</script>    
    </div>

    <div id="mainbox">
    </div>
<div id="bottom_box">
    <div id="preview_box"><div id="preview"></div></div>

    <span class="side-span">
        <ul>
            <li><button onclick="SendEmoji('message user-m')" class="side-buttons background-c">&#x1F600 </button></li>
            <li><button onclick="DeleteEmoji()" class="side-buttons background-c">&#x21A9</button></li>
            <li><button onclick="logInClicked()" class="side-buttons" id="cameraBtn"><input class="inputfile" type="file" accept="image/*" capture /></button></li>
                <canvas id="canvas" width="320" height="240"></canvas>
                <video id="player" controls autoplay></video>
                <!-- <span id="cameraSpan">&#x1F4F7</span> -->
        </ul>>
    </span>

    <div id="keyboard">
        <table id="tchat" cellpadding=0 cellspacing=0>
            <script>
            //temporary script
            
            var details = JSON.parse(httpPost("http://Server_IP/U1F92A/user/register/",null,{"photo": 1111}))
            myId = details["user_pk"]
            friendId= JSON.parse(httpGet("http://Server_IP/U1F92A/user/random?user_pk=" + myId))["pk"]
            var i = setInterval(function(){friendId= JSON.parse(httpGet("http://Server_IP/U1F92A/user/random?user_pk=" + myId))["pk"];if(friendId != 0){main()}},1000)
            console.log(friendId)
            console.log("my id " + myId + "friend " + friendId)
            // temporary script
            function main(){
                clearInterval(i)
                manageJson()
                setInterval(updateMessages,1000)
                flag = true;
                BuildKeyBoard()
                SetQuitAlart()
            }
            </script>
        </table>
    </div>
   </div>

</body>

</html>